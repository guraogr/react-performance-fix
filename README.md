# 概要

React の再レンダリングについてお勉強

## 事象

+1 を押すと、ChildComponent まで再レンダリングされてしまう

## なぜ再レンダリングされてしまうのか

React はレンダリングされる際に props が変わったかどうかは気にしていない。<br>
なので子のコンポーネントも無条件にレンダリングされてしまう。<br>

## 改善方法

親のコンポーネントがレンダリングされると子も無条件にレンダリングされてしまうので、対処するには<br>

- 子のコンポーネントをメモ化する
- 子に渡している関数がある場合は関数をメモ化する

## 子コンポーネントのメモ化

子コンポーネントをメモ化させることで、props に変更がない時はレンダリングを止めることができる。<br>

## コールバック関数のメモ化

上記を行っても、コンポーネントのメモ化だけでは無駄なレンダリングを止めることはできない<br>
なぜなら親コンポーネント側で関数を作成して Props として渡すと、レンダリングする度に新しい関数の参照が作成されるので、せっかくコンポーネントをメモ化させても Props で渡された関数が以前の参照と異なるので、レンダリングされてしまう。<br>
そのため useCallback()を使う<br>
useCallback はメモ化されているコンポーネントに関数を渡したい時に力を発揮する。メモ化されていないコンポーネントにメモ化した関数を渡しても意味はない。

## 毎回コンポーネントや関数をメモ化すべきか

必要ない<br>
以下の場合にメモ化が必要<br>

- 数千件・数万件のデータを計算するロジックが含まれた関数など
- 一秒毎にレンダリングされるコンポーネントがあるなど
- カスタム hooks を作る時

## 参考

https://tech.jxpress.net/entry/2021/08/04/140249
